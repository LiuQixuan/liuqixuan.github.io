<!DOCTYPE html>
<html lang="zh">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="å‰ç«¯canvasç»ƒä¹ ">
	<title>Document</title>
	<style>
		body {
			margin: 0;
			padding: 0;
			overflow: hidden;
		}

		canvas {
			display: block;
			background: rgb(0, 0, 0);
		}
	</style>
</head>

<body>
	<canvas id="canvas"></canvas>
</body>
<script>
	var w = window.innerWidth;
	var h = window.innerHeight;
	var canvas = document.getElementById("canvas");
	canvas.width = w;
	canvas.height = h;
	var ctx = canvas.getContext("2d");

	var text_arr = [`å°å¯çˆ±(â—'â—¡'â—)`, `ä¿ºæƒ³ä½ äº†`, `æ²«æ²«åœ¨å“ªå‘¢`, `ä½ æ˜¯éš¾éš¾ä¹ˆğŸ˜’`,`ç•¥ç•¥ç•¥`,`å°æ´‹äºº`,`è¿˜è®°å¾—æˆ‘å‘¢ï¼ˆoÂ´ãƒ»ã‚§ãƒ»ï½€oï¼‰`,`é‡åˆ°é—®é¢˜æ‰æƒ³èµ·æˆ‘å§(â•¯Â°â–¡Â°ï¼‰â•¯ï¸µ â”»â”â”»`];//æ˜¾ç¤ºæ–‡å­—
	var text_num = 50; //æœ€å¤§å¼¹å¹•æ•°
	var word_arr = []; //å‚¨å­˜æ–‡å­—åæ ‡ç­‰å±æ€§çš„æ•°ç»„
	var txt_min_size = 10; //æ–‡å­—æœ€å°å¤§å°
	var txt_max_size = 50; //æ–‡å­—æœ€å¤§å¤§å°
	var keypress = false; //é»˜è®¤é”®ç›˜æœªç‚¹å‡»çŠ¶æ€ï¼Œç‚¹å‡»é”®ç›˜å®ç°åŠ é€Ÿæ•ˆæœ
	var acclerate = 3; //ç‚¹å‡»é”®ç›˜åŠ é€Ÿé€Ÿç‡

	window.addEventListener('keydown', function () {
		keypress = true;
	}, true);
	window.addEventListener('keyup', function () {
		keypress = false;
	}, true);

	function random(min, max) {
		return Math.random() * (max - min + 1) + min;
	}
	//3Dè§†å·® out_min æœ€å°é€Ÿåº¦ out_max æœ€å¤§é€Ÿåº¦
	function range_map(value, in_min, in_max, out_min, out_max) {
		return (value - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;
	}

	function distance(x, y, x1, y1) {
		return Math.sqrt((x1 - x) * (x1 - x) + (y1 - y) * (y1 - y));
	}

	function saveText() {
		for (let i = 0; i < text_num; i++) {
			let t = {
				x: random(0, w),
				y: random(0, h),
				text: text_arr[~~random(0, text_arr.length)],
				size: ~~random(txt_min_size, txt_max_size)
			}
			word_arr.push(t)
		}
		console.log(word_arr)
	}

	function draw() {
		ctx.clearRect(0, 0, w, h);
		ctx.fillStyle = "#fff";
		for (let i = 0; i < word_arr.length; i++) {
			//æ–‡å­—å¤§å°ï¼Œæ ·å¼
			ctx.font = word_arr[i].size + "px sans-serif";
			//æ–‡å­—å®½åº¦
			var t_w = ctx.measureText(word_arr[i].text);
			ctx.fillText(word_arr[i].text, word_arr[i].x, word_arr[i].y);
			if (keypress) {
				word_arr[i].x += range_map(word_arr[i].size, txt_min_size, txt_max_size, 2, 4) * acclerate;
			} else {
				word_arr[i].x += range_map(word_arr[i].size, txt_min_size, txt_max_size, 2, 3);
			}
			//å¦‚æœå¤§äºçª—å£å®½åº¦ï¼Œé‚£ä¹ˆé‡æ–°è¿”å›ï¼Œå¹¶ä¸”éšæœºyè½´ä½ç½®å’Œå¤§å°
			if (word_arr[i].x >= w) {
				word_arr[i].x = -t_w.width * 5;
				word_arr[i].y = random(0, h);
				word_arr[i].size = ~~random(txt_min_size, txt_max_size);
			}
		}
		ctx.fill()
		window.requestAnimationFrame(draw)
	}
	saveText()
	draw()

</script>

</html>
